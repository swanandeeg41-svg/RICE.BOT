<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>рднрд╛рдд рд╢реЗрддреА рдкреНрд░рд╢реНрдиреЛрддреНрддрд░ (Voice + Online)</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:#f6f7fb; margin:0; padding:24px;}
  .app{max-width:720px; margin:auto; background:#fff; border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,.06); overflow:hidden;}
  header{padding:18px 20px; background:#0ea5e9; color:#fff; display:flex; align-items:center; justify-content:space-between}
  header h1{font-size:18px; margin:0; font-weight:700}
  header small{opacity:.95}
  .content{padding:18px}
  .row{display:flex; gap:8px; align-items:center; margin-top:8px}
  input[type=text]{flex:1; padding:12px 14px; border:1px solid #e5e7eb; border-radius:12px; font-size:16px}
  button{border:0; padding:12px 14px; border-radius:12px; cursor:pointer}
  .mic{background:#22c55e; color:#fff}
  .send{background:#0ea5e9; color:#fff}
  .messages{max-height:52vh; overflow:auto; display:flex; flex-direction:column; gap:10px; padding:8px 0}
  .msg{padding:12px 14px; border-radius:14px; max-width:85%}
  .me{align-self:flex-end; background:#dcfce7}
  .bot{align-self:flex-start; background:#eff6ff}
  .hint{font-size:13px; color:#6b7280}
  .pill{display:inline-block; padding:6px 10px; background:#f1f5f9; border-radius:999px; margin:4px 6px 0 0; cursor:pointer; font-size:13px}
  .pill:hover{background:#e2e8f0}
  details{background:#f8fafc; border-radius:12px; padding:10px 12px; margin-top:12px; border:1px dashed #e5e7eb}
  summary{cursor:pointer; font-weight:600}
  footer{padding:12px 16px; background:#f8fafc; font-size:12px; color:#64748b; display:flex; gap:10px; align-items:center}
  code{background:#f1f5f9; padding:2px 6px; border-radius:6px}
</style>
</head>
<body>
<div class="app">
  <header>
    <h1>ЁЯМ╛ рднрд╛рдд рд╢реЗрддреА рдкреНрд░рд╢реНрдиреЛрддреНрддрд░</h1>
    <small>Voice + Offline Q&A + Online Search</small>
  </header>
  <div class="content">
    <div class="messages" id="messages"></div>

    <div class="hint">рд╕реВрдЪрдирд╛: рдорд░рд╛рдареАрдд рдкреНрд░рд╢реНрди рд╡рд┐рдЪрд╛рд░рд╛. рдСрдирд▓рд╛рдЗрди рдЕрд╕реЗрд▓ рддрд░ рдЕрдзрд┐рдХ рдорд╛рд╣рд┐рддреА рдорд┐рд│реЗрд▓. рдСрдлрд▓рд╛рдИрди рдЙрддреНрддрд░рдВ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЖрд╣реЗрдд.</div>

    <div class="row">
      <input id="q" type="text" placeholder="рдЙрджрд╛. рдмрд┐рдпрд╛рдгреЗ рдЙрдкрдЪрд╛рд░ рдХрд╕рд╛ рдХрд░рд╛рд╡рд╛?">
      <button class="mic" id="micBtn">ЁЯОЩя╕П рдмреЛрд▓рд╛</button>
      <button class="send" id="sendBtn">рдкрд╛рдард╡рд╛</button>
    </div>

    <div style="margin-top:12px">
      <span class="pill" onclick="quick('рдмрд┐рдпрд╛рдгреЗ рдЙрдкрдЪрд╛рд░ рдХрд╕рд╛ рдХрд░рд╛рд╡рд╛?')">рдмрд┐рдпрд╛рдгреЗ рдЙрдкрдЪрд╛рд░</span>
      <span class="pill" onclick="quick('рдмреАрдЬ рдкреНрд░рдХреНрд░рд┐рдпреЗрдд рдХреЛрдгрддреЗ рдФрд╖рдз рд╡рд╛рдкрд░реВ?')">рдФрд╖рдзреЗ</span>
      <span class="pill" onclick="quick('рдзрд╛рдирд╛рдд рддрдг рдирд┐рдпрдВрддреНрд░рдг рдХрдзреА рдХрд░рд╛рд╡реЗ?')">рддрдг рдирд┐рдпрдВрддреНрд░рдг</span>
      <span class="pill" onclick="quick('AWD рд╕рд┐рдВрдЪрди рдкрджреНрдзрдд рдХрд╛рдп рдЖрд╣реЗ?')">AWD</span>
      <span class="pill" onclick="quick('рдмреНрд▓рд╛рд╕реНрдЯ рд░реЛрдЧрд╛рд╡рд░ рдЙрдкрд╛рдп рд╕рд╛рдВрдЧрд╛')">рдмреНрд▓рд╛рд╕реНрдЯ</span>
      <span class="pill" onclick="quick('BPH рддреБрдбрддреБрдбреЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рдХрд╕реЗ?')">BPH</span>
      <span class="pill" onclick="quick('рдпреБрд░рд┐рдпрд╛ рдХрдзреА рджреНрдпрд╛рд╡реА?')">рдпреБрд░рд┐рдпрд╛ рд╡реЗрд│</span>
    </div>

    <details>
      <summary>тЪЩя╕П Online Search рд╕реЗрдЯрдЕрдк (optional)</summary>
      <div style="margin-top:8px; font-size:14px">
        Online fallback рд╕рд╛рдареА рдЦрд╛рд▓реА рддреБрдордЪрд╛ Google Custom Search API рддрдкрд╢реАрд▓ рднрд░рд╛рдГ<br>
        API Key: <input id="apiKey" placeholder="YOUR_API_KEY"> |
        CX: <input id="cxId" placeholder="YOUR_CX_ID">
        <div class="hint">рд╣реЗ рд░рд┐рдХрд╛рдореЗ рдареЗрд╡рд▓реЗ рддрд░реА рдЪрд╛рд▓реЗрд▓; рдЕрд╢рд╛рд╡реЗрд│реА рдлрдХреНрдд рдСрдлрд▓рд╛рдИрди рдЙрддреНрддрд░рдВ рдорд┐рд│рддреАрд▓.</div>
      </div>
    </details>
  </div>

  <footer>
    <div>GitHub Pages рд╕рд╛рдареА рдлрд╛рдИрд▓рдЪреЗ рдирд╛рд╡ <code>index.html</code> рдареЗрд╡рд╛. QR рд╕рд╛рдареА рд▓рд┐рдВрдХ рджреНрдпрд╛.</div>
  </footer>
</div>

<script>
// ---------- Marathi Q&A (offline) ----------
// рдкреНрд░рддреНрдпреЗрдХ entry: {keys: ['keyword1','keyword2'...], answer: 'рдорд░рд╛рдареА рдЙрддреНрддрд░'}
const QA = [
  {keys:['рдмреАрдЬрдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛рдп','рдмреАрдЬ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛рдп','seed treatment рдХрд╛рдп'], answer:'рдмреАрдЬрдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореНрд╣рдгрдЬреЗ рдкреЗрд░рдгреАрдкреВрд░реНрд╡реА рдмрд┐рдпрд╛рдгреНрдпрд╛рдВрдирд╛ рдмреБрд░рд╢реАрдирд╛рд╢рдХ/рдЬреАрд╡рд╛рдгреБрдирд╛рд╢рдХ/рд╕реВрдХреНрд╖реНрдордкреЛрд╖рдХрд╛рдВрдиреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░реВрди рдЙрдЧрд╡рдг рд╡ рд╕реБрд░реБрд╡рд╛рддреАрдЪреЗ рд╕рдВрд░рдХреНрд╖рдг рд╕реБрдзрд╛рд░рдгреЗ.'},
  {keys:['рдмрд┐рдпрд╛рдгреЗ рдЙрдкрдЪрд╛рд░ рдХрд╕рд╛','рдмреАрдЬ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╢реА','treatment kashi'], answer:'рд╢реБрджреНрдз рдмрд┐рдпрд╛рдгреЗ рдШреНрдпрд╛. рдкреНрд░рддрд┐ рдХрд┐рд▓реЛ рдмрд┐рдпрд╛рдгреНрдпрд╛рд╕ рдерд╛рдпрд░рдо 2-3 рдЧреНрд░реЕрдо рдХрд┐рдВрд╡рд╛ рдХрд╛рд░реНрдмреЗрдиреНрдбрд╛рдЭрд┐рдо 2 рдЧреНрд░реЕрдо рдЪреЛрд│рд╛; рд╕рд╛рд╡рд▓реАрдд рд╡рд╛рд│рд╡рд╛. рдЬреИрд╡-рдПрдЬрдВрдЯ рд╣рд╡рд╛ рдЕрд╕рд▓реНрдпрд╛рд╕ рдЯреНрд░рд╛рдпрдХреЛрдбрд░реНрдорд╛ 10 рдЧреНрд░реЕрдо/рдХрд┐рд▓реЛ рд╡рд╛рдкрд░рд╛ (рд░рд╛рд╕рд╛рдпрдирд┐рдХ рд╡ рдЬреИрд╡ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рджрд┐рд╡рд╢реА).'},
  {keys:['рдореАрда рджреНрд░рд╛рд╡рдг','salt solution','рд╣рд▓рдХреЗ рдмреА рд╡реЗрдЧрд│реЗ'], answer:'10 рд▓рд┐. рдкрд╛рдгреНрдпрд╛рдд 300 рдЧреНрд░реЕрдо рдореАрда рдШрд╛рд▓реВрди рджреНрд░рд╛рд╡рдг рддрдпрд╛рд░ рдХрд░рд╛; рдмреА рдЯрд╛рдХрд╛. рд╡рд░ рддрд░рдВрдЧрдгрд╛рд░реЗ рд╣рд▓рдХреЗ/рд░реЛрдЧрдЯ рдмреА рдХрд╛рдвреВрди рдЯрд╛рдХрд╛; рддрд│рд╛рд╢реА рд░рд╛рд╣рд┐рд▓реЗрд▓реЗ рдирд┐рд░реЛрдЧреА рдмреА 2-3 рд╡реЗрд│рд╛ рд╕реНрд╡рдЪреНрдЫ рдкрд╛рдгреНрдпрд╛рдиреЗ рдзреБрд╡рд╛ рд╡ рд╕рд╛рд╡рд▓реАрдд 24 рддрд╛рд╕ рд╡рд╛рд│рд╡рд╛.'},
  {keys:['рдФрд╖рдз рдХреЛрдгрддреЗ','рдХреБрдард▓реЗ рдФрд╖рдз','fungicide'], answer:'рдзрд╛рдирд╛рд╕рд╛рдареА рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдерд╛рдпрд░рдо, рдХрд╛рд░реНрдмреЗрдиреНрдбрд╛рдЭрд┐рдо, рдореЕрдиреНрдХреЛрдЭреЗрдм (combination) рд╡рд╛рдкрд░рддрд╛рдд. рдЬреИрд╡рд┐рдХ рдкрд░реНрдпрд╛рдп: рдЯреНрд░рд╛рдпрдХреЛрдбрд░реНрдорд╛ 10 рдЧреНрд░реЕрдо/рдХрд┐рд▓реЛ. рдиреЗрд╣рдореА рд▓реЗрдмрд▓рд╡рд░реАрд▓ рдкреНрд░рдорд╛рдг рдкрд╛рд│рд╛.'},
  {keys:['рдЙрдЧрд╡рдг рд╡рд╛рдврд╡','germination','рд╡рд┐рдерд░рдг'], answer:'рдмреА 8-12 рддрд╛рд╕ рдХреЛрдордЯ рдкрд╛рдгреНрдпрд╛рдд рднрд┐рдЬрд╡рд╛; рд╕рд╛рд╡рд▓реАрдд рд╡рд╛рд│рд╡рд╛. рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реЗрд▓рд╛ рдмреАрдЙрдкрдЪрд╛рд░ рдХрд░рд╛. рддрд╛рдЬреА рд╡ рдкреНрд░рдорд╛рдгрд┐рдд рдмрд┐рдпрд╛рдгреЗ рд╡рд╛рдкрд░рд╛.'},
  {keys:['рдпреБрд░рд┐рдпрд╛ рдХрдзреА','рдЯреЙрдкрдбреНрд░реЗрд╕','fertilizer schedule'], answer:'рд╕рд╛рдорд╛рдиреНрдпрддрдГ 100:50:50 N:P2O5:K2O рдХрд┐.рдЧреНрд░рд╛./рд╣реЗ. (рдЬрдореАрди-рдкрд░реАрдХреНрд╖рдгрд╛рдиреБрд╕рд╛рд░ рдмрджрд▓рд╛). рдирддреНрд░ рдЕрд░реНрдзреЗ рд░реЛрдкрд╛рдВрддрд░рд╛рд╡реЗрд│реА, рдЙрд░реНрд╡рд░рд┐рдд рджреЛрди рд╣рдкреНрддреЗтАФрдлреБрдЯрд╡реЗ рдлреБрдЯрддрд╛рдирд╛ рд╡ рд▓реЛрдВрдмреАрдЪреНрдпрд╛ рд╕реБрд░реБрд╡рд╛рддреАрд▓рд╛.'},
  {keys:['AWD','рдЕрд▓реНрдЯрд░рдиреЗрдЯ рд╡реЗрдЯрд┐рдВрдЧ','рд╕рд┐рдВрдЪрди рдкрджреНрдзрдд'], answer:'AWD рдордзреНрдпреЗ рдмрд╛рдВрдзреАрдд рдкрд╛рдгреНрдпрд╛рдЪреА рдкрд╛рддрд│реА 5 рд╕реЗрдореА рдареЗрд╡реВрди 3-5 рджрд┐рд╡рд╕рд╛рдВрдиреА рдкрд╛рдгреА рдШрдЯреВ рджреНрдпрд╛; рдлрдЯ рджрд┐рд╕рдгреНрдпрд╛рдЖрдзреА рдкрд░рдд рдкрд╛рдгреА рджреНрдпрд╛. рддреНрдпрд╛рдореБрд│реЗ рдкрд╛рдгреА рдмрдЪрдд рд╡ рдЙрддреНрдкрд╛рджрди рд╕реНрдерд┐рд░ рд░рд╛рд╣рддреЗ.'},
  {keys:['рддрдг рдирд┐рдпрдВрддреНрд░рдг','weed','рдирд┐рдВрджрдг'], answer:'рд░реЛрдкрд╛рдВрддрд░рд╛рдирдВрддрд░ 5-6 рджрд┐рд╡рд╕рд╛рдВрдиреА рдмреБрдЯрд╛рдХреНрд▓реЛрд░ 50 EC ~3.5-4 рд▓рд┐./рд╣реЗ. (500 рд▓рд┐. рдкрд╛рдгреНрдпрд╛рдд) рдХрд┐рдВрд╡рд╛ 15рд╡реНрдпрд╛ рджрд┐рд╡рд╢реА рдирд┐рдВрджрдг-рдХреЛрд│рдкрдгреА; 2-3 рдЖрдард╡рдбреНрдпрд╛рдВрдиреА рдкреБрдирдГ рдирд┐рдВрджрдг рдХрд┐рдВрд╡рд╛ рдХреЛрдиреЛрд╡реАрдбрд░.'},
  {keys:['рдмреНрд▓рд╛рд╕реНрдЯ','рдкрд╛рдирд╛рдВрд╡рд░ рдбрд╛рдЧ','рд░реЛрдЧ рдЙрдкрд╛рдп'], answer:'рд░реЛрдзрдХ рд╡рд╛рдг/рдмреАрдЬрдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░рд╛. рд╕реБрд░реБрд╡рд╛рддреАрд▓рд╛ рдореЕрдиреНрдХреЛрдЭреЗрдм 2-2.5 рдЧреНрд░реЕрдо/рд▓рд┐. рдлрд╡рд╛рд░рдгреА; рддреАрд╡реНрд░рддрд╛ рд╡рд╛рдврд▓реНрдпрд╛рд╕ рдЯреНрд░рд╛рдпрд╕рд╛рдпрдХреНрд▓рд╛рдЭреЙрд▓/рдЖрдЭреЙрдХреНрд╕реАрд╕реНрдЯреНрд░реЛрдмрд┐рди рд╢рд┐рдлрд╛рд░рд╢реАрдкреНрд░рдорд╛рдгреЗ. рдирддреНрд░рд╛рдЪрд╛ рдЕрддрд┐рд░реЗрдХреА рд╡рд╛рдкрд░ рдЯрд╛рд│рд╛.'},
  {keys:['BPH','рддреБрдбрддреБрдбреЗ','рдХрд╛рдВрдбреАрд╡рд░ рдХреАрдб'], answer:'рдкрдЯреНрдЯрд╛ рдкрджреНрдзрддреА/рд╣рд╡реЗрдЪреА рдЦреЗрд│рддреА рдареЗрд╡. рдкрд╛рдгреНрдпрд╛рдЪреА рдкрд╛рддрд│реА рдХрдореА рдХрд░рд╛. рдЖрд░реНрдерд┐рдХ рддреЛрдЯрд╛ рдкрд╛рддрд│реА рдУрд▓рд╛рдВрдбрд▓реНрдпрд╛рд╕ рдЗрдорд┐рдбрд╛рдХреНрд▓реЛрдкреНрд░рд┐рдб/рдмреБрдкреНрд░реЛрдлреЗрдЭрд┐рди рдЗ. рд╢рд┐рдлрд╛рд░рд╕ рдкреНрд░рдорд╛рдгреЗ. рдкреНрд░реМрдв-рдирд┐рдореНрдл рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рд╛.'},
  {keys:['рд░реЛрдкрд╡рд╛рдЯрд┐рдХрд╛','рдирд░реНрд╕рд░реА','seeding rate'], answer:'рдЧрд╛рджреАрд╡рд╛рдлрд╛ 100 рд╕реЗрдореА рд░реБрдВрдж; рдкреНрд░рддрд┐ рдЖрд░ рд╢реЗрдгрдЦрдд ~300 рдХрд┐.рдЧреНрд░рд╛., 1 рдХрд┐.рдЧреНрд░рд╛. рдпреБрд░рд┐рдпрд╛ + 3 рдХрд┐.рдЧреНрд░рд╛. SSP рдорд┐рд╕рд│рд╛. рдмрд╛рд░реАрдХ рдЬрд╛рддреА 30-35 рдХрд┐.рдЧреНрд░рд╛./рд╣реЗ., рдЬрд╛рдб 40-50 рдХрд┐.рдЧреНрд░рд╛./рд╣реЗ.; рд╕рдВрдХрд░рд┐рдд 15-20 рдХрд┐.рдЧреНрд░рд╛./рд╣реЗ.'},
  {keys:['рд░реЛрдкрд╛рдВрдЪреЗ рд╡рдп','рд░реЛрдкрд╛рдВрддрд░','spacing'], answer:'21-25 рджрд┐рд╡рд╕рд╛рдВрдЪреА рд░реЛрдкреЗ; 20x15 рд╕реЗрдореА рдЕрдВрддрд░ (рдкреНрд░рддрд┐ рдЪреБрдб 2-3 рд░реЛрдкреЗ). рд╕рдВрдХрд░рд┐рдд: 15x15 рд╕реЗрдореА рд╡ рдкреНрд░рддрд┐ рдЪреБрдб 1 рд░реЛрдк.'},
  {keys:['рдкрд╛рдгреА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди','water level','рдмрд╛рдВрдзреАрдд рдкрд╛рдгреА'], answer:'рд▓рд╛рд╡рдгреАрдирдВрддрд░ 2.5 рд╕реЗрдореА; рдирдВрддрд░ 5 рд╕реЗрдореА рдкрд░реНрдпрдВрдд. рдлреБрд▓реЛрд▒реНрдпрд╛рд╡реЗрд│реА рддрд╛рдг рджреЗрдК рдирдХрд╛. рдХрд╛рдкрдгреАрдкреВрд░реНрд╡реА 10 рджрд┐рд╡рд╕ рдкрд╛рдгреА рдХрд╛рдврд╛.'},
  {keys:['рд╢реНрд░реА рдкрджреНрдзрдд','SRI','system of rice intensification'], answer:'8-15 рджрд┐рд╡рд╕рд╛рдВрдЪреА рд░реЛрдкреЗ; 20x20 рдХрд┐рдВрд╡рд╛ 25x25 рд╕реЗрдореА, рдкреНрд░рддрд┐ рдЪреБрдб 1 рд░реЛрдк; рдХрдореА рдкрд╛рдгреА, рд╡рд╛рд░рдВрд╡рд╛рд░ рдирд┐рдВрджрдг/рдХреЛрдиреЛрд╡реАрдбрд░; рдмреАрдЬрджрд░ ~5 рдХрд┐.рдЧреНрд░рд╛./рд╣реЗ. рдЙрддреНрдкрд╛рджрди 20-30% рд╡рд╛рдвреВ рд╢рдХрддреЗ.'},
  {keys:['рдХрд╛рдкрдгреА','yield','рдорд│рдгреА'], answer:'рдУрдВрдмреНрдпрд╛рдд 90% рджрд╛рдгреЗ рдкрдХреНрд╡ рдЭрд╛рд▓реНрдпрд╛рд╡рд░ рдХрд╛рдкрдгреА; рдХрдбрдкрд╛ рд╡рд╛рд│рд▓реНрдпрд╛рдирдВрддрд░ рдорд│рдгреА рдХрд░рд╛.'}
];

// ---------- Helpers ----------
function norm(s){
  return (s||'').toLowerCase()
    .replace(/[|/.,!?\-тАУтАФ()]/g,' ')
    .replace(/\s+/g,' ')
    .trim();
}

function searchOffline(q){
  const nq = norm(q);
  // keyword match
  for(const item of QA){
    for(const k of item.keys){
      if(nq.includes(norm(k))) return item.answer;
    }
  }
  // loose match by token intersection
  for(const item of QA){
    const hit = item.keys.some(k=>{
      const kk = norm(k).split(' ');
      const tokens = nq.split(' ');
      let common = kk.filter(t=>tokens.includes(t)).length;
      return common >= Math.max(1, Math.ceil(kk.length*0.6));
    });
    if(hit) return item.answer;
  }
  return null;
}

function addMsg(t, who='bot'){
  const m = document.createElement('div');
  m.className = 'msg ' + (who==='me'?'me':'bot');
  m.textContent = t;
  document.getElementById('messages').appendChild(m);
  m.scrollIntoView({behavior:'smooth', block:'end'});
}

function speak(text){
  try{
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'mr-IN';
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }catch(e){}
}

async function onlineSearch(q){
  const key = document.getElementById('apiKey').value.trim();
  const cx  = document.getElementById('cxId').value.trim();
  if(!key || !cx) return null; // no creds тЖТ skip
  try{
    const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(q)}&key=${encodeURIComponent(key)}&cx=${encodeURIComponent(cx)}`;
    const res = await fetch(url);
    if(!res.ok) return null;
    const data = await res.json();
    if(data.items && data.items[0]){
      // Combine top snippets briefly
      const top = data.items.slice(0,2).map(x=>x.snippet).join(' ');
      return top || null;
    }
  }catch(e){
    return null;
  }
  return null;
}

async function answer(q){
  addMsg(q,'me');
  let a = searchOffline(q);
  if(a){
    addMsg(a,'bot'); speak(a); return;
  }
  addMsg('рдСрдирд▓рд╛рдЗрди рд╢реЛрдзрдд рдЖрд╣реЗтАж','bot');
  const online = await onlineSearch(q);
  if(online){
    addMsg(online,'bot'); speak(online); return;
  }
  const sorry = 'рдХреНрд╖рдорд╕реНрд╡, рд╕рдзреНрдпрд╛ рдпрд╛ рдкреНрд░рд╢реНрдирд╛рдЪрдВ рдЙрддреНрддрд░ рдЙрдкрд▓рдмреНрдз рдирд╛рд╣реА. рдХреГрдкрдпрд╛ рд╡реЗрдЧрд│реНрдпрд╛ рд╢рдмреНрджрд╛рдВрдд рд╡рд┐рдЪрд╛рд░рд╛ рдХрд┐рдВрд╡рд╛ рдСрдирд▓рд╛рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрдЬ рддрдкрд╛рд╕рд╛.';
  addMsg(sorry,'bot'); speak(sorry);
}

// UI events
document.getElementById('sendBtn').addEventListener('click',()=>{
  const q = document.getElementById('q').value.trim();
  if(q) { document.getElementById('q').value=''; answer(q); }
});
document.getElementById('q').addEventListener('keydown',e=>{
  if(e.key==='Enter'){ e.preventDefault(); document.getElementById('sendBtn').click(); }
});
function quick(t){ document.getElementById('q').value=t; document.getElementById('sendBtn').click(); }

// Voice input
document.getElementById('micBtn').addEventListener('click',()=>{
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR){ alert('рддреБрдордЪреНрдпрд╛ рдмреНрд░рд╛рдЙрдЭрд░рдордзреНрдпреЗ voice input рд╕рдкреЛрд░реНрдЯ рдирд╛рд╣реА.'); return; }
  const r = new SR();
  r.lang = 'mr-IN';
  r.interimResults = false;
  r.maxAlternatives = 1;
  r.onresult = (e)=>{
    const text = e.results[0][0].transcript;
    document.getElementById('q').value = text;
    document.getElementById('sendBtn').click();
  };
  r.onerror = ()=> alert('Voice input рдордзреНрдпреЗ рдЕрдбрдЪрдг рдЖрд▓реА.');
  r.start();
});

// Greet
addMsg('рдирдорд╕реНрдХрд╛рд░! рдорд░рд╛рдареАрдд рддреБрдордЪрд╛ рдкреНрд░рд╢реНрди рд╡рд┐рдЪрд╛рд░рд╛. рдЙрджрд╛. "рдмрд┐рдпрд╛рдгреЗ рдЙрдкрдЪрд╛рд░ рдХрд╕рд╛ рдХрд░рд╛рд╡рд╛?"','bot');
</script>
</body>
</html>
